# 应用 (Apps)

## Frappe 应用是什么？

在 Frappe 框架中，**应用（App）** 是一个使用 Frappe 框架的 Python 包。所有 Frappe 应用都存放在 `frappe-bench` 目录下的 `apps` 文件夹中。

- Frappe 自带一个名为 `frappe` 的默认应用，它作为所有其他应用的基础框架。
- 每个应用都应在 `apps.txt` 中有记录。

## 创建应用

通过以下命令可以快速创建一个新的 Frappe 应用（在 `frappe-bench` 目录下执行）：

```bash
$ bench new-app custom_app
```

执行过程中会提示你输入：
- **应用标题**（默认：Custom App）
- **应用描述**
- **发布者名称**
- **联系邮箱**
- **应用图标**（默认使用 octicon）
- **主题色**
- **开源许可证**（默认 MIT）

创建完成后，应用目录会出现在 `apps/custom_app`，并自动加入 `apps.txt`。

## 应用目录结构

一个新创建的 Frappe 应用通常具有如下目录结构：

```
apps/custom_app
├── MANIFEST.in
├── README.md
├── custom_app
│   ├── __init__.py
│   ├── config
│   │   ├── desktop.py
│   │   └── docs.py
│   ├── custom_app          # 与应用同名的模块
│   │   └── __init__.py
│   ├── hooks.py            # 钩子文件，用于扩展框架行为
│   ├── modules.txt         # 定义应用包含的模块
│   ├── patches.txt         # 数据库迁移补丁记录
│   ├── public/             # 静态资源（CSS、JS、图片）
│   ├── templates/          # Jinja 模板文件
│   └── www/                # 门户页面文件
├── requirements.txt        # Python 依赖
├── dev-requirements.txt   # 开发依赖（可选）
├── package.json            # Node.js 依赖
└── setup.py
```

### 关键文件说明：

| 文件/目录 | 用途 |
|----------|------|
| `requirements.txt` | 列出应用所需的 Python 依赖包 |
| `dev-requirements.txt` | 开发环境专用依赖（仅在开发者模式下安装） |
| `package.json` | 定义前端依赖（如 JS 库） |
| `hooks.py` | 用于扩展或覆写 Frappe 的标准行为 |
| `modules.txt` | 列出应用中包含的模块（每个 DocType 属于一个模块） |
| `patches.txt` | 记录数据库迁移时需运行的补丁脚本 |
| `public/` | 存放静态资源，可通过 `/assets/custom_app/...` 访问 |
| `templates/` | 存放 Jinja 模板，支持自定义页面布局 |
| `www/` | 用于构建门户页面（Page），URL 与目录结构对应 |

## 将应用安装到站点（Site）

创建应用后，需要将其安装到具体的站点中，才会在数据库中创建对应的数据表。

安装命令如下：

```bash
$ bench --site site_name install-app custom_app
```

验证安装是否成功：

```bash
$ bench --site site_name list-apps
frappe
custom_app
```

## 总结

- Frappe **应用**是一个符合特定目录结构的 Python 包。
- 使用 `bench new-app` 快速创建应用模板。
- 应用通过 `hooks.py`、`modules.txt` 等文件与 Frappe 框架深度集成。
- 必须使用 `bench install-app` 将应用安装到站点后，才能使用其功能。