# 站点 (Sites)

## 概述

Frappe是一个多租户平台，每个租户称为一个站点（Site）。一个站点拥有自己的数据库。站点存在于一个名为sites的目录中，当运行bench命令时，被假定为当前工作目录。

## 站点目录（SITES DIRECTORY）

sites目录`frappe-bench/sites`是该bench中所有站点的位置。它还包含其他一些文件和目录，接下来将进行说明。

### APPS.TXT

此文件包含Frappe应用的列表。应用必须在列出后才能安装在站点上。当运行`bench get-app`命令或`bench new-app`命令时，会自动添加此文件。

### COMMON_SITE_CONFIG.JSON

所有站点通用的配置可以放在此文件中。了解更多关于站点配置的信息。

### ASSETS

资源包含需要为客户端浏览器提供的文件。这些通常包括*.js、*.css和图像文件。此目录使用`bench build`命令自动生成。在生产环境中，此目录由Nginx提供服务。

## 创建新站点

要从frappe-bench目录创建新站点，请运行以下命令：

```bash
$ bench new-site mysite.localhost
```

输出示例：
```
Installing frappe...
Updating DocTypes for frappe        : [========================================]
Updating country info               : [========================================]
*** Scheduler is disabled ***
```

mysite.local目录现在将在sites目录中创建。

## 站点目录结构

```
sites/mysite.localhost
├── locks
├── private
│   ├── backups
│   └── files
├── public
│   └── files
├── site_config.json
└── task-logs
```

### LOCKS

此目录由调度程序使用，通过文件锁定概念来同步各种作业。

### PRIVATE

此目录包含需要身份验证才能访问的文件。它包含私有文件和备份。可以通过URL访问：`/private/files/private-file.png`。

### PUBLIC

此目录包含可公开访问的文件。可以通过URL访问：`/files/public-file.png`。

### SITE_CONFIG.JSON

此文件包含站点特定配置。

## 站点配置

每个站点目录中都有一个名为site_config.json的文件，用于存储站点特定配置。这些值在frappe.conf局部变量中可作为字典使用。

示例site_config.json：
```json
{
    "db_name": "test_frappe",
    "db_password": "test_frappe",
    "admin_password": "admin",
}
```

要了解更多关于管理站点或Bench级别配置的信息，请查看此综合文档。

## 站点解析

在响应HTTP请求时，站点会根据以下条件自动选择：
- HTTP请求中的Host头与站点匹配
- HTTP请求中的X-Frappe-Site-Name头与站点匹配

也可以通过以下命令强制开发服务器提供特定站点：
```bash
bench --site mysite.localhost serve
```

## 将站点设置为当前站点

要强制将站点用作默认站点，请运行以下命令：
```bash
bench use mysite.localhost
```

运行此命令后，可以不带--site参数运行站点特定命令。

例如，与其运行：
```bash
bench --site mysite.localhost migrate
```

您可以只运行：
```bash
bench migrate
```