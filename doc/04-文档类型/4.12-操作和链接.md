# 操作和链接

> 版本 12.1 新增

操作和链接（也称为连接）是为最终用户提供与文档更多交互的两种方式。

## 操作

一个文档类型（DocType）可以有一些文档类型操作，这将在文档类型视图中创建一个按钮。支持的操作有：

1. **服务器操作**：这将触发一个白名单内的服务器操作。
2. **路由**：这将重定向到给定的路由。

### 操作的配置

### 自定义应用中的操作配置

要在您自己的应用中调用一个操作，您需要一个用 `@frappe.whitelist` 装饰的 Python 函数：

```python
import frappe

@frappe.whitelist()
def execute_function(*args, **kwargs):
    """
    当点击"执行操作"按钮时，将执行此函数。
    """
    print('Hello World')
    # 数据通过关键字参数传输
    print(kwargs)
```

此代码应放在您应用的某个位置，通常在类似 `apps/my_app/my_app/api.py` 的文件中。

然后，配置相应的操作路径。

## 连接（关联文档）

文档类型视图上的一个标准导航辅助工具是仪表板上的"连接"部分。这有助于查看者一目了然地识别哪些文档类型与此文档类型相关联，并可以快速创建新的相关文档。

这些链接还支持添加内部链接（指向子表中文档类型的链接）。

### 连接的配置

### 通过脚本配置

要为您的应用中的某个文档类型配置连接，请在 `<doctype>_dashboard.py` 文件中创建一个 `get_data()` 函数。以下是来自 ERPNext 中销售发票（Sales Invoice）文档类型的 `sales_invoice_dashboard.py` 示例：

```python
from frappe import _

def get_data():
    return {
        "fieldname": "sales_invoice",
        "non_standard_fieldnames": {
            "Delivery Note": "against_sales_invoice",
            "Journal Entry": "reference_name",
            "Payment Entry": "reference_name",
            "Payment Request": "reference_name",
            "Sales Invoice": "return_against",
            "Auto Repeat": "reference_document",
            "Purchase Invoice": "inter_company_invoice_reference",
        },
        "internal_links": {
            "Sales Order": ["items", "sales_order"],
            "Timesheet": ["timesheets", "time_sheet"],
        },
        "internal_and_external_links": {
            "Delivery Note": ["items", "delivery_note"],
        },
        "transactions": [
            {
                "label": _("Payment"),
                "items": [
                    "Payment Entry",
                    "Payment Request",
                    "Journal Entry",
                    "Invoice Discounting",
                    "Dunning",
                ],
            },
            {"label": _("Reference"), "items": ["Timesheet", "Delivery Note", "Sales Order"]},
            {"label": _("Returns"), "items": ["Sales Invoice"]},
            {"label": _("Subscription"), "items": ["Auto Repeat"]},
            {"label": _("Internal Transfers"), "items": ["Purchase Invoice"]},
        ],
    }
```

- `transactions` 定义了所有的连接以及它们所属的组。
- `internal_links` 定义了文档类型具有内部链接的连接。例如，销售发票通过其子表"项目"链接到销售订单文档类型。
- `internal_and_external_links` 定义了文档类型同时具有内部和外部链接的连接。例如，销售发票通过其子表"项目"链接到交货单文档类型（内部链接），同时销售发票也通过其子表"项目"链接到交货单文档类型（外部链接）。
- `fieldname` 定义了在查找文档类型的外部链接时要搜索的默认字段名。
- `non_standard_fieldnames` 定义了在查找文档类型的外部链接时要搜索的字段名及其对应的文档类型。

## 操作和链接的自定义

文档类型操作和链接可以通过"自定义表单"进行扩展。

**请注意**：原始内容中的部分图片和具体配置界面截图在此文本翻译中无法显示，建议您参考原始文档以获取完整的可视化信息。此翻译涵盖了原文中关于"操作和链接"的所有主要概念、配置方法和代码示例。