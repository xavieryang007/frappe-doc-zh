# 权限类型

> 注意：此功能为实验性功能，仅在开发版/每夜构建版中可用。

在 Frappe 框架中，内置了诸如读取、写入、创建、删除和提交等权限类型。然而，某些应用程序需要更细粒度、特定于操作的权限（例如："下载文件"、"模拟用户"或"批准记录"）。

**自定义权限类型** 允许您声明新的权限标志，其行为类似于标准权限类型，但映射到您应用程序中的自定义操作。

## 概览

- **功能**：添加一个命名的权限类型，可以为一个或多个 DocType 分配给角色。
- **存储位置**：权限类型记录会以 fixture 的形式导出到您的应用程序的相应模块下，通常位于 `your_app/your_module/permission_type/<name>.json`。
- **使用方法**：使用"角色权限管理器"将此自定义权限分配给所选 DocType 的角色。在您的代码中，使用 `frappe.has_permission(doc, "<自定义权限名称>")` 来检查权限。

## 创建权限类型

1. 在站点上启用开发者模式，并以 Administrator 身份登录。
2. 通过桌面界面创建一个新的"权限类型"。提供以下信息：
   - **名称** — 唯一的标识符（例如：comment, approve, download）。
   - **DocType** — 此权限类型将应用到的 DocType。
3. 保存记录。导出的 fixture 在您的应用程序安装到其他站点时会包含在内。

创建权限类型后，使用"角色权限管理器"将该权限授予选定 DocType 的角色，就像处理内置权限类型一样。

然后，您可以在代码中简单地检查自定义权限，以控制对相关操作的访问：

```python
if frappe.has_permission(doc, "comment"):
    # 允许自定义操作（例如，创建评论）
    create_comment_for(doc, user)
else:
    frappe.throw("无权限", frappe.PermissionError)
```

## 说明

- 翻译力求准确传达技术概念，并保持了代码示例的原貌。
- 对术语如 `DocType`, `fixture`, `Role Permission Manager` 等进行了保留或常用译法处理。
- 结构上与原文保持一致，便于对照阅读。

希望这份翻译能帮助您理解 Frappe 框架中的权限类型功能。如果您对特定部分有更多疑问，欢迎提出。