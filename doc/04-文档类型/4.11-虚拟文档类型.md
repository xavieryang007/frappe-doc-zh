# 虚拟文档类型

**虚拟文档类型** 是 Frappe 框架中 DocType 的一项功能扩展，允许开发者使用自定义数据源和 DocType 控制器来创建 DocType。其目的是在无需在数据库中创建实际表的情况下，定义系统中的自定义 DocType，同时利用框架提供的前端界面、资源 API 以及角色和权限管理功能。

## 主要特点

- **不依赖数据库表**：虚拟文档类型的数据可以来自外部 API、其他数据库、JSON/CSV 文件等。
- **与常规 DocType 无差别**：在前端及 API 使用上与标准 DocType 完全一致。
- **可自定义控制器方法**：开发者需自行实现数据读取、插入、更新、删除等逻辑。

## 创建虚拟文档类型

在创建 DocType 时，只需勾选"是否为虚拟文档类型"选项即可。

## 创建自定义控制器

示例控制器使用 JSON 文件作为数据源，实现了以下关键方法：

```python
class VirtualDoctype(Document):
    DATA_FILE = "data_file.json"

    @staticmethod
    def get_current_data() -> dict:
        # 读取 JSON 文件数据
        ...

    def db_insert(self, *args, **kwargs):
        # 插入数据到 JSON 文件
        ...

    def load_from_db(self):
        # 从 JSON 文件加载当前文档
        ...

    def db_update(self, *args, **kwargs):
        # 更新数据到 JSON 文件
        ...

    def delete(self):
        # 从 JSON 文件中删除数据
        ...

    @staticmethod
    def get_list(args):
        # 返回文档列表
        ...

    @staticmethod
    def get_count(args):
        # 返回文档总数
        ...

    @staticmethod
    def get_stats(args):
        # 返回统计信息（可选）
        ...
```

## 使用效果

- 虚拟文档类型在前端与标准 DocType 表现一致，用户无法区分。
- 所有 `/api/resource` 接口均兼容虚拟文档类型。

> 提示：此功能自 Frappe 框架第 13 版起可用。

如果需要进一步了解虚拟文档类型的实际应用或控制器方法详细说明，可以查阅 Frappe 官方文档或联系技术团队。