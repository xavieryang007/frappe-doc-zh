# 脚本编写 (Scripting)

## 1. Frappe脚本编写概述

Frappe框架允许直接通过内置功能对标准模型和视图进行脚本编写，无需额外代码。主要支持以下脚本类型：

- **客户端脚本 (Client Script)**：在浏览器端执行，用于表单交互、字段验证等。
- **服务端脚本 (Server Script)**：在服务器端执行，用于业务逻辑、数据验证、自动化任务。
- **脚本报告 (Script Report)**：通过Python代码生成自定义数据报告。
- **系统控制台 (System Console)**：用于直接执行临时脚本或调试。

## 2. 自定义脚本详情

### a. 客户端脚本 (Client Script)

- **作用**：控制表单行为，如字段显示/隐藏、计算、事件触发。
- **常用场景**：
  - 根据字段值动态改变表单布局。
  - 实时校验用户输入。
  - 自动填充字段值。
- **配置方式**：在DocType的"客户端脚本"设置中编写JavaScript代码。

### b. 服务端脚本 (Server Script)

- **作用**：实现业务逻辑、数据验证、工作流自动化。
- **常用场景**：
  - 在文档保存前校验数据。
  - 自动计算字段值（如总额、税率）。
  - 触发邮件通知或更新关联记录。
- **配置方式**：通过"服务端脚本"功能编写Python代码，支持在文档事件（如`before_save`、`on_update`）中执行。

## 3. 自动化支持

Frappe支持多种自动化机制，无需编写完整应用即可实现任务自动化：

- **后台作业 (Background Jobs)**：使用Redis或Celery执行异步任务（如批量数据处理、定时任务）。
- **钩子函数 (Hooks)**：通过应用钩子自动触发脚本（如应用安装后初始化数据）。
- **REST API 集成**：通过API调用外部服务或触发自动化流程。
- **工作流引擎 (Workflow)**：配置状态自动转换和动作触发。

## 4. 脚本API参考

- **JavaScript API**：提供`frappe.call()`、`frappe.db.get_value()`等方法，用于前端与后端交互。
- **Python API**：包括`frappe.get_doc()`、`frappe.db.sql()`等，用于服务端数据操作。
- **Dialog API**：快速创建弹出窗口，用于用户交互。
- **查询构建器 (Query Builder)**：简化数据库查询脚本编写。

## 5. 相关文档章节

您可以在以下目录中找到详细指南：

- **Desk → Scripting**：客户端脚本、服务端脚本、系统控制台的完整说明。
- **Guides → App Development**：包含"执行文档事件代码""添加自定义按钮"等自动化案例。
- **JS API / Python API**：脚本编写的完整API列表和示例。

如果需要具体某类脚本的代码示例或配置步骤，请告诉我，我可以进一步提取对应内容！