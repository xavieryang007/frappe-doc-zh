# 打印 (Printing)

## 一、打印功能概述

Frappe框架内置完善的打印支持，能基于文档自动生成打印格式，并支持转换为PDF。

- **打印视图（Print View）**：在任意文档的表单界面均可访问，系统会根据字段布局自动生成标准打印格式。
- **模板引擎**：使用Jinja进行模板渲染，支持动态内容。

## 二、打印格式定制方式

### 1. **打印格式构建器（Print Format Builder）**

- 适用于基础定制，用户可直接复制标准格式后通过UI拖拽调整字段布局。
- **操作路径**：表单 → 打印预览 → 定制打印格式。

### 2. **自定义HTML**

- 在打印格式编辑器中，可通过"Custom HTML"控件插入自定义代码。
- 支持Bootstrap 3样式及Jinja语法（如动态变量、循环等）。
- 示例代码位置：定制界面左侧工具栏中的"Custom HTML"按钮。

### 3. **自定义CSS**

- 通过 **Customize → Edit Properties** 添加CSS，调整打印样式。
- 提示：需在"Custom CSS"字段中编写样式规则。

### 4. **高级打印格式（代码开发）**

- 适用于完全自定义布局，需通过代码创建：
  1. 在AwesomeBar输入"new print format"创建新格式。
  2. 设置参数：
     - `Standard`：设为"No"（避免自动生成JSON文件）。
     - `Custom Format`：勾选。
     - `Print Format Type`：选择"Jinja"。
  3. 直接编写HTML模板（支持Jinja语法）。
- **注意**：若启用开发者模式且设为"Standard"，需将生成的JSON文件纳入版本控制。

## 三、报表打印格式

- **适用对象**：查询报表（Query Report）和脚本报表（Script Report）。
- **实现方式**：
  - 在报表目录下创建HTML文件（如 `General Ledger.html`）。
  - 使用 **JS模板语法**（类似Jinja，但运行在客户端）。
- 语法示例：
  ```html
  {% for(var i=0; i<data.length; i++) { %}
    <td>{%= data[i].name %}</td>
  {% } %}
  ```

## 四、关键操作入口

| 功能 | 路径 | 说明 |
|------|------|------|
| 打印视图 | 文档表单 → 菜单栏"打印"按钮 | 预览及打印当前文档 |
| 格式定制 | 打印预览界面 → "定制"按钮 | 进入Print Format Builder |
| 高级格式创建 | AwesomeBar输入"new print format" | 通过代码创建完全自定义模板 |

## 五、注意事项

1. **数据动态化**：在Jinja或JS模板中可通过`frappe.format`、`frappe.datetime`等工具函数处理数据。
2. **多语言支持**：模板中可使用`__(\"文本\")`实现国际化。
3. **报表打印**：仅支持通过文件定制，无法通过UI直接修改。

如果需要具体某一部分的代码示例或操作细节，可进一步说明！