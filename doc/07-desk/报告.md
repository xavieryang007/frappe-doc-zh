# 报告 (Reports)

## 1. Frappe报告类型概述

Frappe框架支持三种主要报告类型，适用于不同复杂度的业务需求：

- **Report Builder（报告构建器）**：通过桌面用户界面直接构建的简单报告。
- **Query Report（查询报告）**：基于SQL查询编写的报告。
- **Script Report（脚本报告）**：通过脚本（Python）自定义逻辑生成的报告。

## 2. 报告创建与配置方法

### （1）Report Builder（报告构建器）

- **适用场景**：快速生成简单报表，无需编写代码。
- **操作步骤**：
  1. 进入Frappe Desk的"Report"模块。
  2. 点击"New Report"并选择"Report Builder"。
  3. 选择目标DocType（文档类型），配置筛选条件、显示字段和排序规则。
  4. 保存后即可在报告列表中查看和运行。

### （2）Query Report（查询报告）

- **适用场景**：需要复杂SQL查询或跨表关联的报告。
- **创建方法**：
  - 在代码中定义查询（如通过`.json`文件或Python类）。
  - 示例结构（Python）：
    ```python
    import frappe

    def execute(filters=None):
        columns = [...]
        data = frappe.db.sql("SELECT * FROM `tabYour DocType` WHERE ...")
        return columns, data
    ```
- **配置要点**：
  - 支持参数化筛选条件（filters）。
  - 可通过JSON配置报告的列名和数据类型。

### （3）Script Report（脚本报告）

- **适用场景**：需要动态逻辑处理（如计算字段、条件格式化）。
- **创建方法**：
  - 继承`frappe.core.report.report.Report`类，重写`run`方法。
  - 示例：
    ```python
    class MyScriptReport(Report):
        def run(self, filters):
            # 自定义逻辑
            return columns, data
    ```
- **优势**：支持Python全部功能，可集成其他Frappe API（如权限控制、工作流）。

## 3. 报告的统一视图功能

无论使用Query Report还是Script Report，Frappe均提供统一的UI视图，支持以下功能：

- **导出数据**：支持Excel、CSV格式导出。
- **打印与PDF生成**：一键生成打印布局或PDF文件。
- **自动邮件发送**：配置定时任务，将报告结果通过邮件发送。
- **筛选器界面**：用户可通过前端界面动态筛选数据。

## 4. 配置报告的注意事项

- **权限控制**：可通过Frappe的Role-Based Permissions设置报告访问权限。
- **性能优化**：对大数据量查询建议使用索引或缓存机制。
- **自定义格式化**：可通过JavaScript/CSS定制报告前端显示样式。

## 5. 相关文档参考

- **Query Report详细指南**：查看"Guides- Reports and Printing"中的"How To Make Query Report"。
- **Script Report示例**：参考"Desk - Reports"下的"Script Report"章节。
- **UI定制**：见"Guides - Desk"中的"Making Charts"和"Formatter For Link Fields"。

如果需要具体某类报告的代码示例或配置细节，请进一步说明！