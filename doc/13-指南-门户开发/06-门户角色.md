# 13.6 门户角色 (Portal Roles)

## 门户角色（Portal Roles）

**版本：7.1+**

可以将角色分配给"网站用户"（Website Users），他们将根据其角色看到相应的菜单。

1.  可以在"门户设置"（Portal Settings）中设置一个默认角色。
2.  每个"门户菜单项"（Portal Menu Item）都可以关联一个角色。如果设置了该角色，则只有拥有该角色的用户才能看到该菜单项。
3.  可以在钩子（hooks）中为默认用户设置默认角色的规则。

### 默认角色的规则

例如，如果电子邮件地址与某个联系人ID匹配，则设置"客户"（Customer）或"供应商"（Supplier）角色：

```python
default_roles = [
    {'role': 'Customer', 'doctype':'Contact', 'email_field': 'email_id', 'filters': {'ifnull(customer, "")': ('!=', '')}},
    {'role': 'Supplier', 'doctype':'Contact', 'email_field': 'email_id', 'filters': {'ifnull(supplier, "")': ('!=', '')}},
    {'role': 'Student', 'doctype':'Student', 'email_field': 'student_email_id'}
]
```

### 说明

*   **`default_roles`** 是一个列表，其中每个字典定义了一条规则。
*   **`role`**: 要分配的角色名称（例如：'Customer'）。
*   **`doctype`**: 用于查找匹配记录的文档类型（例如：'Contact'）。
*   **`email_field`**: 在该文档类型中，用于与网站用户电子邮件地址匹配的字段名（例如：'email_id'）。
*   **`filters`**: 一个可选的过滤器字典，用于进一步限制匹配的记录。例如，`{'ifnull(customer, "")': ('!=', '')}` 表示只匹配 `customer` 字段不为空的联系人记录。

通过这种方式，系统可以根据用户的电子邮件地址等信息，在用户访问门户时自动为其分配相应的角色，从而控制其可见的菜单项。