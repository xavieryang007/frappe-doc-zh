# 目录结构

## 概述
当你初始化一个新的`frappe-bench`目录时，将生成以下目录结构：

```
.
├── apps
├── config
│   ├── redis_cache.conf
│   ├── redis_queue.conf
│   └── redis_socketio.conf
├── env
├── logs
├── Procfile
└── sites
    ├── apps.txt
    ├── assets
    ├── common_site_config.json
    └── site1.local
        ├── private
        ├── public
        └── site_config.json
```

## 各目录及文件说明

### 1. apps目录
- **用途**：存放Frappe应用及其相关应用
- **说明**：运行`bench new-app app_name`命令时，新应用会在此目录下初始化。自定义应用也存放在这里
- **相关链接**：[了解更多关于应用的信息](https://docs.frappe.io/framework/user/en/basics/apps)

### 2. sites目录
- **用途**：用于存放站点文件
- **说明**：运行`bench new-site site_name`命令后，站点会在此目录下创建。每个站点通过其目录名区分
- **相关链接**：[了解更多关于站点的信息](https://docs.frappe.io/framework/user/en/basics/sites)

### 3. logs目录
- **用途**：存放各种进程的日志文件
- **说明**：每个日志文件根据其来源的进程命名

### 4. config目录
- **用途**：存放Redis实例的配置文件
- **说明**：Frappe使用3个Redis实例分别管理缓存、任务队列和Socket.IO通信

### 5. env目录
- **用途**：存放Python虚拟环境
- **说明**：Frappe应用和Python包依赖安装在此目录中

### 6. Procfile文件
- **用途**：定义进程管理配置
- **说明**：Frappe使用基于Procfile的进程管理，默认配置如下：

```yaml
redis_cache: redis-server config/redis_cache.conf
redis_socketio: redis-server config/redis_socketio.conf
redis_queue: redis-server config/redis_queue.conf
web: bench serve --port 8000
socketio: /usr/bin/node apps/frappe/socketio.js
watch: bench watch
schedule: bench schedule
worker_short: bench worker --queue short --quiet
worker_long: bench worker --queue long --quiet
worker_default: bench worker --queue default --quiet
```

## 各进程说明

### Redis进程
- **redis_cache**：用于内存缓存的Redis实例
- **redis_socketio**：用于Web和Socket.IO进程间实时通信的Redis实例（发布/订阅模式）
- **redis_queue**：用于管理后台任务队列的Redis实例

### Web服务进程
- **web**：基于Werkzeug的Python Web服务器
- **socketio**：与浏览器建立Socket.IO连接的Node.js服务器，用于实时通信
- **watch**：使用Rollup打包JS/CSS资源的Node.js服务器，并在文件变更时重新构建

### 后台任务进程
- **schedule**：使用Python RQ的任务调度器
- **worker_short**：超时时间为300秒的Python工作进程
- **worker_long**：超时时间为1500秒的Python工作进程
- **worker_default**：超时时间为300秒的Python工作进程

## 总结
Frappe框架的目录结构设计合理，清晰地分离了应用代码、站点数据、配置文件和运行环境，为多租户应用提供了良好的架构基础。

---
*原文链接：https://docs.frappe.io/framework/user/en/basics/directory-structure*