# 架构

## 概述
Frappe框架是一个**全栈、基于Web的框架**，集成了部署生产站点所需的所有工具，包括数据库、缓存、后台作业、实时通知等。

## 核心架构特点

### 1. 基于Python
- 使用`virtualenv`为不同Python版本创建隔离环境
- 支持多版本Python和多版本Frappe的站点部署

### 2. 目录结构
通过`bench init frappe-bench`命令创建的典型目录结构：
```
frappe-bench/
├── sites/       # 存放站点数据
├── apps/        # 存放应用代码
├── env/         # Python虚拟环境
├── config/      # Redis等配置文件
└── logs/        # 日志文件
```

### 3. 进程管理
每个`frappe-bench`实例会独立启动以下进程：
- **Web服务**：处理HTTP请求
- **Redis**：缓存和消息队列
- **Node.js**：实时通信等任务

## 初始化流程
执行`bench init`命令时，框架会自动完成：
- 创建目录结构
- 配置Python虚拟环境
- 下载并安装Frappe应用及Node包依赖
- 构建前端资源（JS/CSS）

## 多进程架构
每个Frappe环境独立运行以下进程：
- **redis_cache**：内存缓存Redis服务
- **redis_socketio**：实时通信的Redis发布/订阅服务
- **redis_queue**：后台任务队列Redis服务
- **web**：基于Werkzeug的Python Web服务器
- **socketio**：Node.js服务，用于浏览器实时通信
- **watch**：资源打包和监听变更的Node.js服务
- **schedule**：Python RQ定时任务调度器
- **worker_short**、**worker_long**、**worker_default**：不同超时时间的后台任务处理进程

## 关键概念
- **Bench工具**：用于管理Frappe环境和多站点部署
- **多租户支持**：通过`sites`目录实现隔离的站点配置
- **资产打包**：前端资源通过构建工具统一管理

## 总结
Frappe框架提供了一个完整的全栈开发环境，通过合理的架构设计实现了高效的开发、部署和维护流程。其多租户架构和内置工具链使得构建和运行复杂的企业级应用变得更加简单可靠。

---
*原文链接：https://docs.frappe.io/framework/user/en/basics/architecture*