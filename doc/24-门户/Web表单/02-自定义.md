# Web表单自定义 (Web Form Customization)

## 24.3 自定义

### Web表单自定义概述
- **目的**：允许用户通过自定义Web表单的布局、样式和功能，以满足特定需求。
- **自定义方式**：通过Web表单文档的"Customization"选项卡进行配置。

### 主要自定义选项
1. **字段布局（Fields Layout）**  
   - 添加**列分隔符**（Column Break）和**节分隔符**（Section Break）来调整表单字段的布局。

2. **多步骤Web表单（Multi-Step Webform）**  
   - 通过添加**页分隔符**（Page Break）将表单分为多个步骤（最多9个页分隔符，即10个页面）。

3. **提交按钮标签（Submit Button Label）**  
   - 自定义提交按钮的显示文本。

4. **横幅图片（Banner Image）**  
   - 为Web表单添加横幅图片。

5. **面包屑导航（Breadcrumbs）**  
   - 通过JSON对象自定义面包屑（仅在启用Web表单列表视图时显示）。

6. **提交后页面（After Submit Page）**  
   - 设置自定义的成功标题和消息。
   - 可配置重定向URL（通过`success_url`字段），在提交5秒后自动跳转。

7. **自定义CSS（Custom CSS）**  
   - 通过添加CSS代码改变Web表单的外观。  
   - 示例代码已提供（如修改边框、背景色等）。

8. **客户端脚本（Client Script）**  
   - 支持使用JavaScript添加交互逻辑，包括：
     - **事件处理**（如字段值变化时触发）。
     - **获取/设置字段值**。
     - **自定义验证**（在保存前检查数据）。
     - **设置字段属性**（如隐藏/显示字段）。
     - **表单加载后的初始化脚本**。

### 客户端脚本示例
- **重置无效值**：
  ```javascript
  frappe.web_form.on('amount', (field, value) => {
    if (value < 1000) {
      frappe.msgprint('值必须大于1000');
      field.set_value(0);
    }
  });
  ```
- **自定义验证**：
  ```javascript
  frappe.web_form.validate = () => {
    let data = frappe.web_form.get_values();
    if (data.amount < 1000) {
      frappe.msgprint('值必须大于1000');
      return false; // 阻止提交
    }
  };
  ```
- **根据值隐藏字段**：
  ```javascript
  frappe.web_form.on('amount', (field, value) => {
    frappe.web_form.set_df_property('rate', 'hidden', value < 1000);
  });
  ```
- **表单加载时显示消息**：
  ```javascript
  frappe.web_form.after_load = () => {
    frappe.msgprint('请仔细填写所有值');
  };
  ```

### 注意事项
- 所有自定义选项均需通过Web表单的"Customization"选项卡配置。
- 多步骤表单的页数限制为10页。
- 客户端脚本需谨慎使用，避免影响表单性能。