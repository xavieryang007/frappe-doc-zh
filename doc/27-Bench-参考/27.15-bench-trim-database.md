# 27.15 bench trim-database

## **用法**
```bash
bench trim-database [选项]
```

## **描述**
从列表视图删除 DocType 可能不会从数据库中删除其对应的表。迁移有时会在您的站点数据库中留下幽灵表（ghost tables）。这样做可能是为了冗余，以便在数据损坏或丢失时进行恢复，或者仅仅是人为错误的情况。

此命令会删除任何似乎是上述残留物的表。它将在删除这些表之前尝试对其进行部分备份。如果这些表是必需的，并且被错误地删除，您可以使用 `partial-restore` 命令在站点数据库中恢复它们。

## **选项**
- `--format, -f`：设置输出格式。可用选项为 JSON 和 Table。默认为 Table。

## **标志**
- `--dry-run`：显示将要删除的内容（模拟运行，不实际执行删除）。
- `--no-backup`：在修剪之前不备份站点。

## **示例**

1. **查看将要删除的数据（模拟运行）**：
   ```bash
   bench --site {site} trim-database --dry-run
   ```

2. **以 JSON 格式输出（便于机器解析）**：
   ```bash
   bench --site {site} trim-database --format json
   ```

## **关键说明**
- **适用场景**：当您的数据库中存在无用的幽灵表（如已删除的 DocType 对应的表或迁移残留）时，可使用此命令清理。
- **备份机制**：默认情况下，命令会尝试对要删除的表进行部分备份。如果不希望备份，可使用 `--no-backup` 标志。
- **谨慎操作**：删除操作不可逆。建议先使用 `--dry-run` 查看将要删除的内容，确认无误后再执行。

**相关链接**: https://docs.frappe.io/framework/user/en/bench/reference/trim-database