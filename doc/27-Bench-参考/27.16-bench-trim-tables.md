# 27.16 bench trim-tables

## **用法**
```bash
bench trim-tables [选项]
```

## **描述**
从特定 DocType 中删除的文档字段（Docfields）可能不会从其数据库表中实际删除。这是 Frappe 的设计特性，旨在防止过早的数据丢失。在大多数情况下，这不会造成问题，但某些时候这些残留数据可能会导致一些问题。

定期进行表修剪的好处包括：
- 更小的备份文件大小
- 减少站点备份所需时间
- 减少站点数据库使用量
- 在使用 `SELECT *` 查询时优化查询性能
- 数据库保持清洁，没有隐藏或冗余数据

**注意**：此命令会修改您站点数据库中的表结构。默认情况下，在修改之前会对整个数据库进行完整备份。如果这些表被错误修改，您可以使用 `restore` 命令将站点恢复到原始状态。

## **选项**
- `--format`, `-f`：设置输出格式。可用选项为 JSON 和 TEXT，默认为 TEXT。

## **标志**
- `--dry-run`：显示将要删除的内容（模拟运行，不实际执行删除）。
- `--no-backup`：不备份站点（不推荐使用，因为这是一个破坏性操作）。

## **示例**

1. **可能存在许多占用空间的残留列**。例如，在自定义 DocType 时遇到行大小限制错误时，您可以运行以下命令来确认是否存在幽灵列或旧的隐藏字段占用空间：
   ```bash
   bench --site {site} trim-tables --dry-run
   ```

## **重要提示**
- 此操作会修改数据库结构，请谨慎使用。
- 强烈建议在执行前进行备份（除非使用 `--no-backup` 标志）。
- 使用 `--dry-run` 标志可以先预览将要执行的操作，而不实际修改数据库。

**相关链接**: https://docs.frappe.io/framework/user/en/bench/reference/trim-tables