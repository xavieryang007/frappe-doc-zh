# 27.11 bench restore

## **用法**
```bash
bench restore [选项] SQL文件路径
```

## **描述**
`bench restore` 命令可用于将现有站点恢复到特定状态。您可以指定要恢复的数据库备份文件以及（可选的）公共和私有文件存档。

**重要提示**：
- **不支持降级**：如果检测到您正在尝试将站点恢复到更旧的 Frappe/ERPNext 版本（即降级），命令会显示一个交互式提示警告。请谨慎操作。
- **仅恢复文件**：目前，无法使用此命令仅恢复文件而不恢复数据库。
- **备份文件格式**：
  - **数据库备份**：支持 `.sql.gz` 或 `.sql` 扩展名。
  - **文件备份**：默认支持 `.tar` 存档。从版本 13 开始，也支持 `.tgz`（压缩）存档。

## **参数**
- `SQL文件路径`：数据库备份源文件的路径。此路径可以是相对于 bench 目录根目录或 `sites` 文件夹的相对路径，也可以是绝对路径。

## **选项**
- `--db-root-username`：MariaDB 或 PostgreSQL 的 root 用户名。
- `--db-root-password`：MariaDB 或 PostgreSQL 的 root 密码。
- `--db-name`：为新站点指定的数据库名称（如果是一个新站点）。
- `--admin-password`：为恢复后的站点设置管理员密码。
- `--install-app`：在恢复后安装指定的应用。
- `--with-public-files`：恢复站点的公共文件，需要提供其存档文件的路径。
- `--with-private-files`：恢复站点的私有文件，需要提供其存档文件的路径。

## **标志**
- `--force`：忽略站点降级警告（如果适用）。除非您完全了解后果，否则不推荐使用此标志。

## **示例**

1. **恢复站点及其文件（数据库、公共文件、私有文件）**：
   ```bash
   bench --site {site_name} restore {path/to/database/file} \
   --with-public-files {path/to/public/archive} \
   --with-private-files {path/to/private/archive}
   ```

2. **通过选项传递数据库凭证，避免交互式提示**：
   ```bash
   bench --site {site_name} restore {path/to/database/file} \
   --db-root-username {db_root_user} \
   --db-root-password {db_root_pass}
   ```

3. **在站点恢复后安装特定应用**：
   ```bash
   bench --site {site_name} restore {path/to/database/file} \
   --install-app {app_name}
   ```

4. **为恢复的站点指定自定义数据库名称**：
   ```bash
   bench --site {site_name} restore {path/to/database/file} \
   --db-name {custom_database_name}
   ```

5. **重置恢复后站点的管理员密码**：
   ```bash
   bench --site {site_name} restore {path/to/database/file} \
   --admin-password {new_admin_password}
   ```

**注意**：在所有示例中，`{site_name}` 是您要恢复的目标站点的名称，`{path/to/database/file}` 是您的数据库备份文件（如 `backup.sql.gz`）的路径。请将占位符替换为实际的值。

**相关链接**: https://docs.frappe.io/framework/user/en/bench/reference/restore