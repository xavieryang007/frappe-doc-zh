# 27.5 bench backup

## **用法**
```bash
bench backup [选项]
```

## **描述**
备份指定的站点。执行基础命令将创建数据库转储，压缩并保存在默认备份位置 `./sites/{site}/private/backups`。

如果当前设置了站点，直接运行 `bench backup` 命令将备份该站点。

## **选项**
- `--backup-path`：设置此操作中所有文件的保存路径
- `--backup-path-db`：设置数据库文件的保存路径
- `--backup-path-conf`：设置配置文件的保存路径
- `--backup-path-files`：设置公共文件的保存路径
- `--backup-path-private-files`：设置私有文件的保存路径
- `--exclude, -e`：指定不备份的 DocType，用逗号分隔
- `--only, --include, -i`：指定要备份的 DocType，用逗号分隔

## **标志**
- `--ignore-backup-conf`：忽略配置中设置的排除/包含项
- `--with-files`：备份包含私有和公共文件
- `--compress`：压缩私有和公共文件
- `--verbose`：增加详细输出

## **示例**

1. **备份站点的私有和公共文件**
   ```bash
   bench --site {site} backup --with-files
   ```

2. **压缩公共和私有文件（如果需要）**。这将文件保存为 tgz 格式而不是默认的 tar 格式。
   ```bash
   bench --site {site} backup --with-files --compress
   ```

3. **更改备份文件的保存路径**
   ```bash
   bench --site {site} backup --backup-path {backup_path}
   ```

4. **更改特定备份文件的路径**。对于每个未指定的选项，相应文件将保存在默认位置。
   ```bash
   bench --site {site} backup --with-files
      --backup-path-conf {conf_path}
      --backup-path-db {db_path}
      --backup-path-files {files_path}
      --backup-path-private-files {private_path}
   ```

5. **为 Bench CLI 内部管理的各个阶段增加详细输出**
   ```bash
   bench --site {site} backup --verbose
   ```

6. **仅备份站点上的某些 doctype**
   ```bash
   bench --site {site} backup --only 'ToDo,Note,Task,Project,Sales Invoice'
   ```

7. **备份除某些 doctype 外的所有表**
   ```bash
   bench --site {site} backup --exclude 'Error Log,Access Log,Activity Log,Version'
   ```

8. **备份完整站点，忽略 frappe.conf.backup.* 值（如果已指定）**
   ```bash
   bench --site {site} backup --ignore-backup-conf
   ```

如果备份过程失败（引发任何异常）- 文件将被删除以避免占用额外磁盘空间。

**相关链接**: https://docs.frappe.io/framework/user/en/bench/reference/backup