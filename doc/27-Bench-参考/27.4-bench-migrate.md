# 27.4 bench migrate

## **用法**
```bash
bench migrate [选项]
```

## **描述**
`migrate` 命令将站点状态更新至当前可用的应用版本。它会按顺序执行以下任务：

1. **运行前置迁移钩子（before_migrate Hooks）**
2. **运行应用补丁（Application Patches）**
3. **同步数据库架构和后台作业（Synchronize Database Schema and Background Jobs）**
4. **同步固件（Synchronize Fixtures）**
5. **同步仪表板、桌面图标和网页（Synchronize Dashboards, Desktop Icons and Web Pages）**
6. **更新翻译（Updates Translations）**
7. **为所有路由重建搜索索引（Rebuild Search Index for all routes）**
8. **运行后置迁移钩子（after_migrate Hooks）**

该操作还会更新相应文件的 `touched_tables.json`，并在"已安装应用"文档类型中更新应用版本。

## **标志（Flags）**
- `--skip-failing`：跳过运行失败的应用补丁。
- `--skip-search-index`：跳过为网页文档重建搜索索引。

## **示例**

1. **在现有站点上运行迁移**
   ```bash
   bench --site {site} migrate
   ```

2. **运行迁移但跳过重建网页文档的搜索索引**
   ```bash
   bench --site {site} migrate --skip-search-index
   ```

3. **运行迁移并跳过任何失败的应用补丁**
   ```bash
   bench --site {site} migrate --skip-failing
   ```

> **注意**：在生产环境中不建议使用跳过失败补丁的选项。

**相关链接**: https://docs.frappe.io/framework/user/en/bench/reference/migrate